# ソフトウェア開発のステップ

## 0. 目的とスコープ設定
- 何を「最初の勝ち筋（MVP価値）」にするかを1つ決める
- 対象ユーザーと利用シーンを1〜2行で書く
- 今回やらないこと（Not in scope）も明記する

## 1. ユビキタス言語（用語集）を作る
- 名詞・動詞を収集して一覧化する（同義語・曖昧語をつぶす）
- UI文言 / API名 / クラス名の基準になる「正式名称」を決める
- 例：企業 / 発行体、決算短信 / 有報、指標 / KPI などの整理

成果物：
- 用語集


## 2. ドメインの境界を粗く切る
- 衝突しやすい領域だけ分ける
  - 収集（Fetch/Crawl）
  - 正規化（Normalize / 名寄せ）
  - 解析（Extract / 指標計算）
  - 表示（Query / View）

成果物：
- 境界のラフ図（Context Mapの簡易版でOK）

## 3. 主要ユースケース（ユーザー行動）を列挙する
- 「ユーザーが何をしたいか」を動詞で書く。（CRUDで書かない）
- 例：
  - 企業を検索する
  - 企業を比較する
  - 企業の時系列イベントを見る
  - 指標の推移を見る

成果物：
- ユースケース一覧

## 4. ドメインモデル（エンティティ / 値オブジェクト）を起こす
- エンティティ（IDで追跡するもの）と値（値オブジェクト）で分ける
- 例：
    - Entity: Compnay, Document, Event,,
    - Value: Period, Money, Ratio, IndustryCode

成果物：
- モデル一覧（責務と主要属性）

## 5. 集約（Aggregate）と不変条件（Invariant）を決める
- 「一緒に更新される単位」を集約として定義する
- 集約の中で守るべきルール（不変条件）を書く
- 例：
    - Documentは提出日と対象期間が必須
    - MetricValueは(Company, Metric, Period)で一意、など

成果物：
- 集約図（Aggregate図）
- 不変条件リスト

## 6. 状態（スナップショット）とイベント（時系列）を分ける
- 変化が価値の中心なら、イベントモデルを明示する
- 状態：最新プロフィール / 最新の集計
- イベント：決算、ニュース、IR、指標更新、抽出完了 など

成果物：
- 時系列モデル（Event/Snapshotの関係）

## 7. データの出どころ（Source of Truth）を決める
- どの情報が「原本」か、どれが「派生」かを固定する
- 例：
  - 原本：提出書類（PDF/HTML/開示本文）
  - 派生：抽出テキスト、指標計算結果、要約、埋め込み

成果物：
- データ分類表（原本/派生/キャッシュ）

## 8. 読みモデル（Queryモデル）を設計する
- UI/検索/比較で必要な“読み方”を先に決める（更新モデルと分ける）
- 例：
  - 企業詳細ページ用のCompanyOverviewView
  - 比較用のCompanyCompareView
  - タイムライン用のCompanyTimelineView

成果物：
- 画面/機能ごとのQueryモデル定義（必要項目一覧）


## 9. 永続化方針を決める（DB方式と役割分担）
- どれをRDBに置くか、検索/ベクトル/グラフをどう分けるか
- 例（典型）：
  - RDB：正規化された基礎データ、整合性が必要なもの
  - Search：全文検索・ランキング
  - Graph：関係探索、因果っぽい繋がり
  - Vector：類似検索、要約/検索補助

成果物：
- ストア分割方針（Storage Strategy）


## 10. DB論理設計（テーブル/コレクション/ノード・エッジ）を起こす
- 集約と不変条件に沿ってスキーマ化する
- 一意制約・参照・インデックス方針まで決める
- Queryモデルに対して必要なインデックスを張る

成果物：
- ER図 or Graphスキーマ図
- インデックス/制約一覧
- 主要クエリの想定（SQL/Gremlin/Cypherのラフ）