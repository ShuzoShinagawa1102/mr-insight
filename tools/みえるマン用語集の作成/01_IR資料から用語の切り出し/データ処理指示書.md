# データ処理指示書（みえるマン用語集・有報抽出）

## 目的
みえるマンの用語集を作るために、企業の有価証券報告書（PDF）から **企業分析に使える用語** を抜き出し、後工程（正規化・Concept化・メタデータ付与）の材料を作る。

## スコープ（厳守）
- 情報源は **resources配下の有価証券報告書PDFのみ**
- 外部サイト・一般辞書・推測補完はしない（言い換えはOK、追加知識はNG）

## 入力
- `resources/XX_企業名/` 配下のPDF（当該企業の有価証券報告書）

## 出力（必須）

### 0) 出力フォルダ構成（新）
- `output/XX_企業名/` を作成（`resources` と同じ企業ディレクトリ構成）
- `output/XX_企業名/` 直下に、当該企業の **有報PDFのみ** をコピーする（他ファイルは入れない）

### 1) 単語リスト
- `output/XX_企業名/wordList/wordList.txt` を作成
- 形式は **1行1語、重複は排除**
- 上限：**最大10,000語**

例：
```
売上高
売上原価
連結財務諸表
のれん
減損損失
...
```

### 2) メタデータ付きリスト
- `output/XX_企業名/metadata/wordList.jsonl` を作成（1行1JSON）
- `wordList/wordList.txt` の語をベースに、**最低限のメタデータ**を付与する

例（JSONL）：
```json
{"word":"売上高","description":"一定期間における売上の総額","metadata":{"pos":"名詞","conceptType":"Metric","category":"PL","source":"有価証券報告書","company":"XX"}}
```

> ※ description は「有報内でのニュアンス」を優先し、一般辞書的な説明になりすぎないこと。

### 3) 作業ログ
- `output/XX_企業名/worklog.md` に出力
- 処理手順、除外基準、例外判断などを簡潔に記録する

---

## 用語の採用ルール

### 採用（優先）
- 財務・会計・開示関連  
  - 売上高、売上原価、営業利益、収益認識、減損、のれん、繰延税金資産 等
- 経営・事業関連  
  - セグメント、事業戦略、KPI、顧客基盤、事業ポートフォリオ 等
- リスク・法務・ガバナンス  
  - リスク要因、内部統制、コンプライアンス、訴訟、個人情報保護 等
- 企業固有の言い回し  
  - プロダクト名、サービス名、独自指標名、組織名称 等

### 除外（原則）
- 一般的・非専門的な日本語  
  - 当社、本書、重要、内容、場合、以下、なお 等
- 助詞・助動詞・接続詞  
  - は、が、を、ため、しかし 等
- 年月日、ページ番号、章番号、単なる数値の羅列
- 会社名のみの繰り返し表現（例：「株式会社〇〇」）

### 判断に迷う場合
- 「有報特有の言い回し」 → 採用寄り
- 「どの文章にも出る一般語」 → 除外寄り
- 判断に迷った語は worklog にメモを残す

---

## 一時データの扱い
- AIのコンテキスト制限を超える可能性がある場合、`temp_for_ai/` を使用してよい
- ただし **情報源は有価証券報告書のみ** という前提は維持する  

---

## 用語データ構造（暫定）

```ts
type POS = "名詞" | "動詞" | "修飾子" | "その他"
type ConceptType = "Entity" | "Metric" | "Event" | "State" | "Structure" | "Time" | "Other"

interface WordEntry {
  word: string
  description?: string
  metadata: {
    pos: POS
    conceptType: ConceptType
    category?: string
    source: "有価証券報告書"
  }
}
```

---

## 想定作業フロー（AI側）

0. `resources`配下を読み込み、作成する企業を把握する。
1. X番目の企業をPDFを読み込み、用語候補を抽出
2. 除外ルールに基づいてフィルタリング
3. 重複排除し、上限10,000語に収める（重要語優先）
4. `output/XX_企業名/` を作り、当該企業の有報PDFのみをコピー
5. `output/XX_企業名/wordList/wordList.txt` を出力
6. 同一語を `output/XX_企業名/metadata/wordList.jsonl` でメタデータ付与して出力
7. `output/XX_企業名/worklog.md` に処理内容・判断基準・例外を記録
8. 手順1に戻り、X+1番目の企業の処理を開始する。（この時、処理を続けるか、いったんストップするかユーザーに指示を仰ぐ）
